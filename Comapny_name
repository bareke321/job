from fuzzywuzzy import fuzz
import pandas as pd

# read in the datasets
df1 = pd.read_csv('companies1.csv') # first dataset with company names and IDs
df2 = pd.read_csv('companies2.csv') # second dataset with similar company names

# create a function to find the best match for a company name in df2
def find_best_match(name, df):
    best_score = 0
    best_index = None
    for i, row in df.iterrows():
        score = fuzz.token_sort_ratio(name, row['name'])
        if score > best_score:
            best_score = score
            best_index = i
    if best_index is not None:
        return df.loc[best_index]
    else:
        return None

# match the companies from df1 to the closest company in df2
df1['matched_company'] = df1['name'].apply(lambda x: find_best_match(x, df2))

# output the results
for i, row in df1.iterrows():
    print(f"{row['name']} ({row['id']}) matched with {row['matched_company']['name']} ({row['matched_company']['id']})")
